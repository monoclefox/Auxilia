<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessibility Checker - Auxilia</title>
    <script src="https://cdn.jsdelivr.net/npm/culori@4/bundled/culori.umd.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        .checker-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .contrast-section, .colorblind-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
        }
        
        .color-input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .color-input {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .color-input input {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-family: monospace;
            font-size: 1rem;
        }
        
        .color-swatch {
            width: 100%;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
        }
        
        .contrast-result {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .contrast-ratio {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .wcag-badges {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .badge-pass {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-fail {
            background: #f8d7da;
            color: #721c24;
        }
        
        .text-preview {
            background: var(--bg-color, #ffffff);
            color: var(--text-color, #000000);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .preview-normal {
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .preview-large {
            font-size: 1.25rem;
            font-weight: 700;
        }
        
        .colorblind-preview {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .colorblind-card {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
        }
        
        .colorblind-label {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #555;
        }
        
        .colorblind-swatch {
            width: 100%;
            height: 60px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        
        @media (max-width: 768px) {
            .checker-grid {
                grid-template-columns: 1fr;
            }
            
            .color-input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="auxilia.html" class="nav-brand">Auxilia</a>
        <ul class="nav-links">
            <li><a href="auxilia.html">Home</a></li>
            <li><a href="oklch-converter.html">OKLCH Converter</a></li>
            <li><a href="accessibility-checker.html" class="active">Accessibility Checker</a></li>
            <li><a href="palette-generator.html">Palette Generator</a></li>
            <li><a href="design-token-manager.html">Token Manager</a></li>
        </ul>
    </nav>

    <div class="main-container">
        <div class="container wide-container">
            <h1>Accessibility Checker</h1>
            <p class="description">
                Check WCAG contrast ratios and simulate color blindness to ensure your colors are accessible to all users.
            </p>

            <div class="checker-grid">
                <!-- Contrast Checker Section -->
                <div class="contrast-section">
                    <h2 class="section-title">Contrast Ratio Checker</h2>
                    
                    <div class="color-input-group">
                        <div class="color-input">
                            <label for="foreground-color">Foreground (Text)</label>
                            <input type="text" id="foreground-color" value="#000000" placeholder="#000000">
                            <div class="color-swatch" id="foreground-swatch"></div>
                        </div>
                        <div class="color-input">
                            <label for="background-color">Background</label>
                            <input type="text" id="background-color" value="#ffffff" placeholder="#ffffff">
                            <div class="color-swatch" id="background-swatch"></div>
                        </div>
                    </div>

                    <div class="contrast-result">
                        <div class="contrast-ratio" id="contrast-ratio">21.0</div>
                        <div class="wcag-badges">
                            <span class="badge badge-pass" id="aa-normal">AA Normal</span>
                            <span class="badge badge-pass" id="aa-large">AA Large</span>
                            <span class="badge badge-pass" id="aaa-normal">AAA Normal</span>
                            <span class="badge badge-pass" id="aaa-large">AAA Large</span>
                        </div>
                        
                        <div class="text-preview" id="text-preview">
                            <div class="preview-normal">Normal text (16px+) - This is how your text will look.</div>
                            <div class="preview-large">Large text (18px+ bold, 24px+ regular)</div>
                        </div>
                    </div>
                </div>

                <!-- Color Blindness Simulator Section -->
                <div class="colorblind-section">
                    <h2 class="section-title">Color Blindness Simulation</h2>
                    
                    <div class="color-input">
                        <label for="simulate-color">Color to Simulate</label>
                        <input type="text" id="simulate-color" value="#ff6b35" placeholder="#ff6b35">
                        <div class="color-swatch" id="simulate-swatch"></div>
                    </div>
                    
                    <div class="colorblind-preview">
                        <div class="colorblind-card">
                            <div class="colorblind-label">Original</div>
                            <div class="colorblind-swatch" id="original-swatch"></div>
                        </div>
                        <div class="colorblind-card">
                            <div class="colorblind-label">Protanopia<br><small>(Red-blind)</small></div>
                            <div class="colorblind-swatch" id="protanopia-swatch"></div>
                        </div>
                        <div class="colorblind-card">
                            <div class="colorblind-label">Deuteranopia<br><small>(Green-blind)</small></div>
                            <div class="colorblind-swatch" id="deuteranopia-swatch"></div>
                        </div>
                        <div class="colorblind-card">
                            <div class="colorblind-label">Tritanopia<br><small>(Blue-blind)</small></div>
                            <div class="colorblind-swatch" id="tritanopia-swatch"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <footer class="site-footer">
        Made for Jenn<span class="heart">ðŸ’œ</span>by Geoff
    </footer>

    <script>
        // Get DOM elements
        const foregroundInput = document.getElementById('foreground-color');
        const backgroundInput = document.getElementById('background-color');
        const simulateInput = document.getElementById('simulate-color');
        
        const foregroundSwatch = document.getElementById('foreground-swatch');
        const backgroundSwatch = document.getElementById('background-swatch');
        const simulateSwatch = document.getElementById('simulate-swatch');
        
        const contrastRatio = document.getElementById('contrast-ratio');
        const textPreview = document.getElementById('text-preview');
        
        // Badge elements
        const aaNormal = document.getElementById('aa-normal');
        const aaLarge = document.getElementById('aa-large');
        const aaaNormal = document.getElementById('aaa-normal');
        const aaaLarge = document.getElementById('aaa-large');
        
        // Color blindness swatches
        const originalSwatch = document.getElementById('original-swatch');
        const protanopiaSwatch = document.getElementById('protanopia-swatch');
        const deuteranopiaSwatch = document.getElementById('deuteranopia-swatch');
        const tritanopiaSwatch = document.getElementById('tritanopia-swatch');

        // WCAG contrast ratio calculation
        function calculateContrastRatio(color1, color2) {
            try {
                const rgb1 = culori.rgb(color1);
                const rgb2 = culori.rgb(color2);
                
                if (!rgb1 || !rgb2) return null;
                
                const l1 = getRelativeLuminance(rgb1);
                const l2 = getRelativeLuminance(rgb2);
                
                const lighter = Math.max(l1, l2);
                const darker = Math.min(l1, l2);
                
                return (lighter + 0.05) / (darker + 0.05);
            } catch (error) {
                return null;
            }
        }
        
        function getRelativeLuminance(rgb) {
            const { r, g, b } = rgb;
            
            const srgb = [r, g, b].map(c => {
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });
            
            return 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];
        }
        
        function updateBadge(element, passes, label) {
            element.textContent = label;
            element.className = `badge ${passes ? 'badge-pass' : 'badge-fail'}`;
        }
        
        function updateContrastChecker() {
            const fg = foregroundInput.value.trim();
            const bg = backgroundInput.value.trim();
            
            // Update swatches
            foregroundSwatch.style.backgroundColor = fg;
            backgroundSwatch.style.backgroundColor = bg;
            
            // Calculate contrast ratio
            const ratio = calculateContrastRatio(fg, bg);
            
            if (ratio) {
                contrastRatio.textContent = ratio.toFixed(2);
                
                // Update WCAG compliance badges
                updateBadge(aaNormal, ratio >= 4.5, 'AA Normal');
                updateBadge(aaLarge, ratio >= 3.0, 'AA Large');
                updateBadge(aaaNormal, ratio >= 7.0, 'AAA Normal');
                updateBadge(aaaLarge, ratio >= 4.5, 'AAA Large');
                
                // Update text preview
                textPreview.style.setProperty('--bg-color', bg);
                textPreview.style.setProperty('--text-color', fg);
            } else {
                contrastRatio.textContent = 'â€”';
                updateBadge(aaNormal, false, 'AA Normal');
                updateBadge(aaLarge, false, 'AA Large');
                updateBadge(aaaNormal, false, 'AAA Normal');
                updateBadge(aaaLarge, false, 'AAA Large');
            }
        }
        
        // Color blindness simulation matrices
        const colorBlindMatrices = {
            protanopia: [
                [0.567, 0.433, 0],
                [0.558, 0.442, 0],
                [0, 0.242, 0.758]
            ],
            deuteranopia: [
                [0.625, 0.375, 0],
                [0.7, 0.3, 0],
                [0, 0.3, 0.7]
            ],
            tritanopia: [
                [0.95, 0.05, 0],
                [0, 0.433, 0.567],
                [0, 0.475, 0.525]
            ]
        };
        
        function simulateColorBlindness(color, type) {
            try {
                const rgb = culori.rgb(color);
                if (!rgb) return color;
                
                const matrix = colorBlindMatrices[type];
                const r = rgb.r * matrix[0][0] + rgb.g * matrix[0][1] + rgb.b * matrix[0][2];
                const g = rgb.r * matrix[1][0] + rgb.g * matrix[1][1] + rgb.b * matrix[1][2];
                const b = rgb.r * matrix[2][0] + rgb.g * matrix[2][1] + rgb.b * matrix[2][2];
                
                return culori.formatHex({ mode: 'rgb', r: Math.max(0, Math.min(1, r)), g: Math.max(0, Math.min(1, g)), b: Math.max(0, Math.min(1, b)) });
            } catch (error) {
                return color;
            }
        }
        
        function updateColorBlindnessSimulation() {
            const color = simulateInput.value.trim();
            
            // Update main swatch
            simulateSwatch.style.backgroundColor = color;
            originalSwatch.style.backgroundColor = color;
            
            // Simulate different types of color blindness
            protanopiaSwatch.style.backgroundColor = simulateColorBlindness(color, 'protanopia');
            deuteranopiaSwatch.style.backgroundColor = simulateColorBlindness(color, 'deuteranopia');
            tritanopiaSwatch.style.backgroundColor = simulateColorBlindness(color, 'tritanopia');
        }
        
        // Event listeners
        foregroundInput.addEventListener('input', updateContrastChecker);
        backgroundInput.addEventListener('input', updateContrastChecker);
        simulateInput.addEventListener('input', updateColorBlindnessSimulation);
        
        // Initial updates
        updateContrastChecker();
        updateColorBlindnessSimulation();
    </script>
</body>
</html>