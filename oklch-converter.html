<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKLCH â†” Hex Converter - Auxilia</title>
    <script src="https://cdn.jsdelivr.net/npm/culori@4/bundled/culori.umd.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        .hex-output {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .hex-value {
            flex: 1;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="auxilia.html" class="nav-brand">Auxilia</a>
        <ul class="nav-links">
            <li><a href="auxilia.html">Home</a></li>
            <li><a href="oklch-converter.html" class="active">OKLCH Converter</a></li>
            <li><a href="accessibility-checker.html">Accessibility Checker</a></li>
            <li><a href="palette-generator.html">Palette Generator</a></li>
            <li><a href="design-token-manager.html">Token Converter</a></li>
        </ul>
    </nav>

    <div class="main-container">
        <div class="page-header">
            <h1>OKLCH â†” Hex Converter</h1>
            <p class="description">
                Convert between OKLCH and hexadecimal color formats. 
                Adjust the OKLCH values or enter a hex code to see real-time conversion in both directions.
            </p>
        </div>

        <div class="input-group">
            <label for="lightness">Lightness (L)</label>
            <div class="input-with-range">
                <input type="number" id="lightness" min="0" max="1" step="0.001" value="0.7">
                <input type="range" id="lightness-range" min="0" max="1" step="0.001" value="0.7">
                <span class="range-value" id="lightness-value">0.700</span>
            </div>
            <div class="input-hint">Range: 0 (black) to 1 (white)</div>
        </div>

        <div class="input-group">
            <label for="chroma">Chroma (C)</label>
            <div class="input-with-range">
                <input type="number" id="chroma" min="0" max="0.4" step="0.001" value="0.1">
                <input type="range" id="chroma-range" min="0" max="0.4" step="0.001" value="0.1">
                <span class="range-value" id="chroma-value">0.100</span>
            </div>
            <div class="input-hint">Range: 0 (gray) to 0.4+ (vivid)</div>
        </div>

        <div class="input-group">
            <label for="hue">Hue (H)</label>
            <div class="input-with-range">
                <input type="number" id="hue" min="0" max="360" step="0.1" value="250">
                <input type="range" id="hue-range" min="0" max="360" step="0.1" value="250">
                <span class="range-value" id="hue-value">250.0</span>
            </div>
            <div class="input-hint">Range: 0Â° to 360Â° (color wheel)</div>
        </div>

        <div class="color-preview" id="color-preview"></div>

        <div class="input-group">
            <label for="hex-input">Hex Value</label>
            <div class="hex-output">
                <input type="text" class="hex-value" id="hex-input" value="#b8a9db" placeholder="#ffffff">
                <button class="copy-button" onclick="copyHex()">Copy</button>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        Made for Jenn<span class="heart">ðŸ’œ</span>by Geoff
    </footer>

    <script>
        const lightnessInput = document.getElementById('lightness');
        const lightnessRange = document.getElementById('lightness-range');
        const lightnessValue = document.getElementById('lightness-value');
        
        const chromaInput = document.getElementById('chroma');
        const chromaRange = document.getElementById('chroma-range');
        const chromaValue = document.getElementById('chroma-value');
        
        const hueInput = document.getElementById('hue');
        const hueRange = document.getElementById('hue-range');
        const hueValue = document.getElementById('hue-value');
        
        const colorPreview = document.getElementById('color-preview');
        const hexInput = document.getElementById('hex-input');

        function syncInputs(input, range, valueSpan, decimals = 3) {
            input.addEventListener('input', () => {
                range.value = input.value;
                valueSpan.textContent = parseFloat(input.value).toFixed(decimals);
                convertColor();
            });

            range.addEventListener('input', () => {
                input.value = range.value;
                valueSpan.textContent = parseFloat(range.value).toFixed(decimals);
                convertColor();
            });
        }

        syncInputs(lightnessInput, lightnessRange, lightnessValue, 3);
        syncInputs(chromaInput, chromaRange, chromaValue, 3);
        syncInputs(hueInput, hueRange, hueValue, 1);

        // Add event listener for hex input changes
        hexInput.addEventListener('input', convertFromHex);

        function convertColor() {
            const l = parseFloat(lightnessInput.value);
            const c = parseFloat(chromaInput.value);
            const h = parseFloat(hueInput.value);

            // Create OKLCH color object
            const oklchColor = {
                mode: 'oklch',
                l: l,
                c: c,
                h: h
            };

            // Convert to hex using culori
            const hexColor = culori.formatHex(oklchColor);
            
            // Update outputs
            hexInput.value = hexColor;
            colorPreview.style.backgroundColor = hexColor;
        }

        function convertFromHex() {
            let hexValue = hexInput.value.trim();
            
            // Auto-handle # prefix
            if (hexValue && !hexValue.startsWith('#')) {
                hexValue = '#' + hexValue;
                hexInput.value = hexValue; // Update input field to show the #
            }
            
            // Validate hex format
            if (!/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$/.test(hexValue)) {
                return; // Invalid hex format, don't convert
            }

            try {
                // Convert hex to OKLCH using culori
                const oklchColor = culori.oklch(hexValue);
                
                if (oklchColor && typeof oklchColor.l === 'number') {
                    // Update OKLCH inputs and sliders
                    const l = Math.max(0, Math.min(1, oklchColor.l || 0));
                    const c = Math.max(0, Math.min(0.4, oklchColor.c || 0));
                    const h = isNaN(oklchColor.h) ? 0 : (oklchColor.h || 0) % 360;

                    // Update inputs with proper rounding
                    const roundedL = Math.round(l * 1000) / 1000; // Round to 3 decimals
                    const roundedC = Math.round(c * 1000) / 1000; // Round to 3 decimals  
                    const roundedH = Math.round(h * 10) / 10;     // Round to 1 decimal

                    lightnessInput.value = roundedL;
                    lightnessRange.value = roundedL;
                    lightnessValue.textContent = roundedL.toFixed(3);

                    chromaInput.value = roundedC;
                    chromaRange.value = roundedC;
                    chromaValue.textContent = roundedC.toFixed(3);

                    hueInput.value = roundedH;
                    hueRange.value = roundedH;
                    hueValue.textContent = roundedH.toFixed(1);

                    // Update color preview
                    colorPreview.style.backgroundColor = hexValue;
                }
            } catch (error) {
                // Invalid color, ignore
                console.warn('Invalid color:', hexValue);
            }
        }

        function copyHex() {
            const hexText = hexInput.value;
            navigator.clipboard.writeText(hexText).then(() => {
                const button = document.querySelector('.copy-button');
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 1000);
            });
        }

        // Initial conversion
        convertColor();
    </script>
</body>
</html>